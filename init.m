% 完整经验气动数据，无控状态，非整流罩数据，准确大气模型 2s 1820 5.5s 660
clear all;
close all;
%% 目标参数
xt0 = 2500;
yt0 = 5000;
zt0 = 0;
Vt = 200;
%% PID参数
Kp_ny = 5;
Kd_ny = 5;
Kp_nz = 5;
Kd_nz = 5;
Kp_gamma = 5;
Kd_gamma = 5;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
g = 9.8;
K = 4;
Tg = 0.4;
Actuator_Tg = 0.1;
%Sref = 0.0116899;
Sref = 0.0038465;
ro = 0.6523
D = 0.122
%L = 3.015
L = 1.2;%1.345
wx0 = 0;
wy0 = 0;
wz0 = 0;
V0 = 0.6*340;%0.01;
angle = 8;
theta0 = angle/57.3;
fai_v0 = 0;
x0 = 0;
y0 = 5000;
z0 = 0;
sit0 = angle/57.3;
fai0 = 0;
gama0 = 0;
t_propshutdown = 9.5;
t_masschange = 9.5;
Tg = 0.5;
% total = 4620;
% i1 = 2870;
%i2 = (total -1*i1)/4
% i2 = 1045;
%P = 1000*[0, 19.5677, 19.0966, 18.9362, 18.8909, 19.278, 19.6938, 20.2806, 20.8791, 21.3872, 21.9055, 22.6319, 23.6276, 24.6004, 25.7755, 26.7868, 27.7934, 28.8228, 29.8655, 31.1, 32.0811, 30.6371, 29.2214, 25.2674, 19.8733, 14.696, 7.2462, 2.087, 0];
% P = [i1, i1, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2, i2];
P = 0:0.5:t_propshutdown;
P(1:5) = 1870;
P(6:end) = 470;
m = linspace(12+2,9.2,length(P));
Ixx = linspace(0.007,0.006,length(P));
Iyy = linspace(1.0920,0.7440,length(P));
t_change = 0:0.5:t_propshutdown;
%P = [5000, 5000, 300, 300, 300, 300, 300, 300, 300, 300, 300];
%m = [71.0000, 70.5287, 69.5975, 68.6814, 67.7704, 66.8511, 65.9124, 64.9496, 63.9583, 62.9403, 61.8976, 60.8249, 59.7107, 58.5491, 57.3358, 56.0698, 54.7553, 53.3917, 51.9781, 50.5098, 48.9880, 47.4775, 46.0357, 44.7234, 43.6361, 42.8035, 42.2751, 42.0503, 42.0000];
%m = [10.0000, 9.7700, 9.5400, 9.3100, 9.0800, 8.8500, 8.6200, 8.3900, 8.1600, 7.9300, 7.7000];
% m = [12.0000, 11.7000, 11.4000, 11.1000, 10.8000, 10.5000, 10.2000, 9.9000, 9.6000, 9.3000, 9.0000];
% Ixx = [0.0070, 0.0069, 0.0068, 0.0067, 0.0066, 0.0065, 0.0064, 0.0063, 0.0062, 0.0061, 0.0060]; 
% Iyy = [1.0920, 1.0572, 1.0224, 0.9876, 0.9528, 0.9180, 0.8832, 0.8484, 0.8136, 0.7788, 0.7440];
Izz = Iyy;
%alphaRange = [-12, -10, -8, -6, -4, -2, -1, 0, 1, 2, 4, 6, 8, 10, 12];
alphaRange = [-30, -25, -20, -15, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 15, 20, 25, 30];
deltazRange = [-20, -15, -10, -5, 0, 5, 10, 15, 20];
deltayRange = deltazRange;
% deltazRange = [0];
% deltayRange = deltazRange;
betaRange = alphaRange;
deltax = 0;
deltay = 0;
deltaz = 0;
h = [0 2 4 6 8 10 12 14 16 18 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 100 110 120 130 140 150 160 170 180 190 200 220 240 260 280 300 400 500 600 700 800 900];

%MachRange  = [0.6, 0.8, 0.9, 1, 1.2, 1.5, 2, 2.5, 3];
MachRange = [0.6, 1.2, 1.5, 1.8, 2.2];
airDensity = [1.225 1.0066 .81935 .66011 .52579 .41351 .31194 .22786 .16647 .12165 .08891 .040084 .01841 .0084634 .0039957 .0019663 .0010269 .0005681 .00030968 .00016321 .000082829 .000039921 .000018458 .0000082196 .000003416 .0000005604 .00000009708 .00000002222 .000000008152 .000000003831 .000000002076 .000000001233 .0000000007815 .0000000005194 .0000000003581 .0000000002541 .0000000001367 .00000000007858 .00000000004742 .00000000002971 .00000000001916 .000000000002802 5.215E-13 1.137E-13 3.069E-14 1.136E-14 5.759E-15];
% %升力系数，0舵偏，-30度到+30度迎角，0.6到2.2马赫
%  CL1(:,:) = [[0.000  0.393  0.931  1.589  2.296  2.936  3.477  4.493  6.068  7.928  10.201  13.886]
%              [0.000 0.4435 0.9981 1.6599 2.3995 3.1482 3.8779 5.0749 6.6612 8.2986 10.2752 12.4571]
%              [0.000 0.4177  0.9626  1.6205  2.3462  3.0787  3.8096  5.1259  6.7806  8.3240  10.3283  13.0242]
%              [0.0000  0.3945  0.9151  1.5549  2.2691  3.0004  3.7911  5.1022  6.5720  8.1180  10.3218  13.0099]
%              [0.0000  0.3761  0.8683  1.4758  2.1892  2.9458  3.6525  4.8760  6.3017  7.8341  9.9281   12.4444]];
% Cy = [-CL1(:,12:-1:2), CL1].';
% 
% CD1 = [[0.326, 0.339, 0.391, 0.493, 0.649, 0.843, 1.062, 1.52, 2.272, 3.312, 4.964, 8.005]
%        [0.6606, 0.6754, 0.7290, 0.8376, 1.0123, 1.2409, 1.5179, 2.0468, 2.8353, 3.8523, 5.4441, 7.8121]
%        [0.7350, 0.7507, 0.8065, 0.9167, 1.0840, 1.3025, 1.5723, 2.1261, 2.9428, 3.9406, 5.5594, 8.2522]
%        [0.7306, 0.7447, 0.7984, 0.9045, 1.0642, 1.2791, 1.5580, 2.1129, 2.8784, 3.8679, 5.5735, 8.2745]
%        [0.6950, 0.7088, 0.7605, 0.8614, 1.0190, 1.2355, 1.4948, 2.0203, 2.7734, 3.7462, 5.3898, 7.9686]];
% Cx = [CD1(:,12:-1:2), CD1].'*1.12;
% 
%阻力系数，-20度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(1,:,:) = [[17.348, 14.101, 10.919, 7.739, 5.955, 4.864, 3.876, 3.017, 2.297, 1.725, 1.300, 1.023, 0.910, 0.953, 1.142, 1.463, 1.902, 2.727, 4.485, 6.744, 9.375]
             [20.358, 15.254, 10.834, 7.270, 5.494, 4.471, 3.585, 2.838, 2.228, 1.765, 1.452, 1.283, 1.266, 1.404, 1.692, 2.126, 2.705, 3.822, 6.359, 9.903, 14.282]
             [15.422, 11.351, 7.895, 5.271, 4.057, 3.368, 2.767, 2.255, 1.832, 1.502, 1.271, 1.143, 1.124, 1.218, 1.426, 1.749, 2.189, 3.068, 5.241, 8.279, 11.960]
             [14.731, 10.832, 7.468, 4.801, 3.621, 2.985, 2.443, 1.989, 1.621, 1.335, 1.133, 1.019, 1.003, 1.089, 1.283, 1.585, 2.001, 2.867, 4.971, 7.745, 11.003]
             [14.583, 10.665, 7.380, 4.707, 3.448, 2.756, 2.203, 1.777, 1.448, 1.197, 1.022, 0.901, 0.876, 0.956, 1.143, 1.438, 1.864, 2.741, 4.694, 7.156, 10.194]];
% %阻力系数，-15度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(2,:,:) = [[16.813, 13.425, 9.840, 6.599, 4.881, 3.857, 2.957, 2.201, 1.595, 1.137, 0.837, 0.687, 0.682, 0.814, 1.070, 1.438, 1.906, 2.777, 4.681, 7.167, 10.067]
             [19.668, 14.549, 10.005, 6.479, 4.768, 3.795, 2.959, 2.271, 1.740, 1.363, 1.134, 1.047, 1.102, 1.300, 1.637, 2.106, 2.709, 3.864, 6.497, 10.190, 14.738]
             [14.972, 10.990, 7.563, 4.893, 3.672, 2.983, 2.389, 1.894, 1.499, 1.207, 1.019, 0.939, 0.970, 1.113, 1.364, 1.724, 2.193, 3.115, 5.377, 8.528, 12.320]
             [13.995, 10.251, 6.991, 4.446, 3.290, 2.662, 2.130, 1.688, 1.337, 1.077, 0.909, 0.836, 0.862, 0.991, 1.225, 1.562, 2.004, 2.911, 5.097, 7.970, 11.321]
             [13.609, 9.830, 6.740, 4.231, 3.030, 2.405, 1.908, 1.510, 1.201, 0.966, 0.796, 0.730, 0.760, 0.882, 1.099, 1.420, 1.867, 2.776, 4.791, 7.338, 10.497]];
% %阻力系数，-10度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(3,:,:) = [[16.044, 12.281, 8.640, 5.523, 3.926, 3.000, 2.211, 1.568, 1.081, 0.752, 0.570, 0.519, 0.592, 0.778, 1.068, 1.464, 1.976, 2.943, 5.063, 7.834, 10.998]
             [18.892, 13.669, 9.173, 5.757, 4.119, 3.201, 2.440, 1.836, 1.389, 1.095, 0.944, 0.923, 1.032, 1.271, 1.635, 2.129, 2.765, 3.986, 6.757, 10.632, 15.364]
             [14.621, 10.636, 7.160, 4.491, 3.282, 2.610, 2.042, 1.582, 1.229, 0.983, 0.846, 0.816, 0.895, 1.078, 1.361, 1.751, 2.255, 3.237, 5.605, 8.869, 12.759]
             [13.392, 9.777, 6.627, 4.108, 2.966, 2.352, 1.836, 1.417, 1.097, 0.876, 0.752, 0.723, 0.792, 0.959, 1.222, 1.587, 2.063, 3.024, 5.303, 8.271, 11.705]
             [12.756, 9.205, 6.241, 3.851, 2.726, 2.129, 1.651, 1.275, 0.968, 0.766, 0.660, 0.642, 0.707, 0.857, 1.098, 1.441, 1.912, 2.863, 4.968, 7.647, 10.871]];
% %阻力系数，-5度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(4,:,:) = [[14.772, 11.011, 7.497, 4.586, 3.145, 2.328, 1.653, 1.136, 0.770, 0.547, 0.452, 0.466, 0.580, 0.795, 1.126, 1.584, 2.174, 3.281, 5.674, 8.717, 12.132]
             [17.942, 12.788, 8.407, 5.113, 3.576, 2.739, 2.059, 1.538, 1.169, 0.945, 0.854, 0.880, 1.022, 1.286, 1.683, 2.221, 2.910, 4.222, 7.163, 11.232, 16.146]
             [14.224, 10.206, 6.729, 4.093, 2.921, 2.282, 1.755, 1.340, 1.035, 0.840, 0.753, 0.768, 0.882, 1.096, 1.415, 1.847, 2.395, 3.445, 5.918, 9.283, 13.253]
             [12.937, 9.395, 6.268, 3.778, 2.661, 2.069, 1.582, 1.201, 0.923, 0.745, 0.665, 0.678, 0.781, 0.976, 1.273, 1.676, 2.193, 3.213, 5.582, 8.629, 12.118]
             [12.142, 8.685, 5.858, 3.555, 2.460, 1.884, 1.413, 1.055, 0.809, 0.659, 0.594, 0.607, 0.698, 0.871, 1.137, 1.510, 2.016, 3.028, 5.259, 7.968, 11.228]];
% %阻力系数，0度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(5,:,:) = [[13.421, 9.794, 6.492, 3.834, 2.553, 1.857, 1.303, 0.894, 0.621, 0.472, 0.427, 0.472, 0.621, 0.894, 1.303, 1.857, 2.553, 3.834, 6.492, 9.794, 13.421]
             [17.011, 11.972, 7.718, 4.596, 3.174, 2.416, 1.814, 1.363, 1.057, 0.886, 0.833, 0.886, 1.057, 1.363, 1.814, 2.416, 3.174, 4.596, 7.718, 11.972, 17.011]
             [13.756, 9.742, 6.302, 3.735, 2.620, 2.024, 1.543, 1.178, 0.923, 0.774, 0.727, 0.774, 0.923, 1.178, 1.543, 2.024, 2.620, 3.735, 6.302, 9.742, 13.756]
             [12.532, 9.011, 5.914, 3.471, 2.395, 1.838, 1.392, 1.053, 0.819, 0.684, 0.641, 0.684, 0.819, 1.053, 1.392, 1.838, 2.395, 3.471, 5.914, 9.011, 12.532]
             [11.616, 8.302, 5.545, 3.291, 2.209, 1.649, 1.232, 0.930, 0.728, 0.612, 0.575, 0.612, 0.728, 0.930, 1.232, 1.649, 2.209, 3.291, 5.545, 8.302, 11.616]];
% %阻力系数，5度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(6,:,:) = [[12.132, 8.717, 5.674, 3.281, 2.174, 1.584, 1.126, 0.795, 0.580, 0.466, 0.452, 0.547, 0.770, 1.136, 1.653, 2.328, 3.145, 4.586, 7.497, 11.011, 14.772]
             [16.146, 11.232, 7.163, 4.222, 2.910, 2.221, 1.683, 1.286, 1.022, 0.880, 0.854, 0.945, 1.169, 1.538, 2.059, 2.739, 3.576, 5.113, 8.407, 12.788, 17.942]
             [13.253, 9.283, 5.918, 3.445, 2.395, 1.847, 1.415, 1.096, 0.882, 0.768, 0.753, 0.840, 1.035, 1.340, 1.755, 2.282, 2.921, 4.093, 6.729, 10.206, 14.224]
             [12.118, 8.629, 5.582, 3.213, 2.193, 1.676, 1.273, 0.976, 0.781, 0.678, 0.665, 0.745, 0.923, 1.201, 1.582, 2.069, 2.661, 3.778, 6.268, 9.395, 12.937]
             [11.228, 7.968, 5.259, 3.028, 2.016, 1.510, 1.137, 0.871, 0.698, 0.607, 0.594, 0.659, 0.809, 1.055, 1.413, 1.884, 2.460, 3.555, 5.858, 8.685, 12.142]];
% %阻力系数，10度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(7,:,:) = [[10.998, 7.834, 5.063, 2.943, 1.976, 1.464, 1.068, 0.778, 0.592, 0.519, 0.570, 0.752, 1.081, 1.568, 2.211, 3.000, 3.926, 5.523, 8.640, 12.281, 16.044]
             [15.364, 10.632, 6.757, 3.986, 2.765, 2.129, 1.635, 1.271, 1.032, 0.923, 0.944, 1.095, 1.389, 1.836, 2.440, 3.201, 4.119, 5.757, 9.173, 13.669, 18.892]
             [12.759, 8.869, 5.605, 3.237, 2.255, 1.751, 1.361, 1.078, 0.895, 0.816, 0.846, 0.983, 1.229, 1.582, 2.042, 2.610, 3.282, 4.491, 7.160, 10.636, 14.621]
             [11.705, 8.271, 5.303, 3.024, 2.063, 1.587, 1.222, 0.959, 0.792, 0.723, 0.752, 0.876, 1.097, 1.417, 1.836, 2.352, 2.966, 4.108, 6.627, 9.777, 13.392]
             [10.871, 7.647, 4.968, 2.863, 1.912, 1.441, 1.098, 0.857, 0.707, 0.642, 0.660, 0.766, 0.968, 1.275, 1.651, 2.129, 2.726, 3.851, 6.241, 9.205, 12.756]];
% %阻力系数，15度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(8,:,:) = [[10.067, 7.167, 4.681, 2.777, 1.906, 1.438, 1.070, 0.814, 0.682, 0.687, 0.837, 1.137, 1.595, 2.201, 2.957, 3.857, 4.881, 6.599, 9.840, 13.425, 16.813]
             [14.738, 10.190, 6.497, 3.864, 2.709, 2.106, 1.637, 1.300, 1.102, 1.047, 1.134, 1.363, 1.740, 2.271, 2.959, 3.795, 4.768, 6.479, 10.005, 14.549, 19.668]
             [12.320, 8.528, 5.377, 3.115, 2.193, 1.724, 1.364, 1.113, 0.970, 0.939, 1.019, 1.207, 1.499, 1.894, 2.389, 2.983, 3.672, 4.893, 7.563, 10.990, 14.972]
             [11.321, 7.970, 5.097, 2.911, 2.004, 1.562, 1.225, 0.991, 0.862, 0.836, 0.909, 1.077, 1.337, 1.688, 2.130, 2.662, 3.290, 4.446, 6.991, 10.251, 13.995]
             [10.497, 7.338, 4.791, 2.776, 1.867, 1.420, 1.099, 0.882, 0.760, 0.730, 0.796, 0.966, 1.201, 1.510, 1.908, 2.405, 3.030, 4.231, 6.740, 9.830, 13.609]];
% %阻力系数，20度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cx(9,:,:) = [[9.375, 6.744, 4.485, 2.727, 1.902, 1.463, 1.142, 0.953, 0.910, 1.023, 1.300, 1.725, 2.297, 3.017, 3.876, 4.864, 5.955, 7.739, 10.919, 14.101, 17.348]
             [14.282, 9.903, 6.359, 3.822, 2.705, 2.126, 1.692, 1.404, 1.266, 1.283, 1.452, 1.765, 2.228, 2.838, 3.585, 4.471, 5.494, 7.270, 10.834, 15.254, 20.358]
             [11.960, 8.279, 5.241, 3.068, 2.189, 1.749, 1.426, 1.218, 1.124, 1.143, 1.271, 1.502, 1.832, 2.255, 2.767, 3.368, 4.057, 5.271, 7.895, 11.351, 15.422]
             [11.003, 7.745, 4.971, 2.867, 2.001, 1.585, 1.283, 1.089, 1.003, 1.019, 1.133, 1.335, 1.621, 1.989, 2.443, 2.985, 3.621, 4.801, 7.468, 10.832, 14.731]
             [10.194, 7.156, 4.694, 2.741, 1.864, 1.438, 1.143, 0.956, 0.876, 0.901, 1.022, 1.197, 1.448, 1.777, 2.203, 2.756, 3.448, 4.707, 7.380, 10.665, 14.583]];
% 
% %升力系数，-20度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(1,:,:) = [[-24.393, -23.153, -21.173, -18.038, -15.586, -13.730, -11.756, -9.721, -7.661, -5.626, -3.658, -1.731, 0.153, 1.963, 3.674, 5.275, 6.751, 8.661, 11.627, 14.582, 17.166]
             [-30.766, -26.763, -22.271, -17.696, -14.771, -12.750, -10.705, -8.639, -6.557, -4.522, -2.609, -0.735, 1.177, 3.087, 4.969, 6.807, 8.610, 11.215, 15.600, 20.451, 25.075]
             [-22.941, -20.006, -16.465, -12.890, -10.866, -9.506, -8.118, -6.706, -5.254, -3.771, -2.293, -0.813, 0.696, 2.197, 3.674, 5.141, 6.582, 8.714, 12.600, 16.597, 19.986]
             [-21.772, -19.096, -15.726, -11.956, -9.858, -8.556, -7.268, -5.971, -4.679, -3.380, -2.072, -0.748, 0.600, 1.972, 3.366, 4.748, 6.138, 8.291, 12.083, 15.596, 18.424]
             [-21.353, -18.632, -15.506, -11.833, -9.480, -7.950, -6.573, -5.330, -4.162, -3.015, -1.882, -0.627, 0.646, 1.890, 3.150, 4.457, 5.878, 8.111, 11.527, 14.443, 17.095]];
% %升力系数，-15度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(2,:,:) = [[-24.877, -23.425, -20.670, -17.051, -14.412, -12.455, -10.408, -8.334, -6.265, -4.228, -2.334, -0.556, 1.164, 2.794, 4.318, 5.725, 7.096, 9.161, 12.506, 15.792, 18.605]
             [-30.769, -26.635, -21.771, -16.994, -13.988, -11.915, -9.802, -7.677, -5.595, -3.589, -1.728, 0.066, 1.886, 3.695, 5.470, 7.195, 8.934, 11.616, 16.212, 21.261, 26.013]
             [-22.887, -20.004, -16.449, -12.714, -10.595, -9.158, -7.692, -6.212, -4.700, -3.179, -1.675, -0.182, 1.315, 2.782, 4.209, 5.607, 7.001, 9.180, 13.196, 17.281, 20.697]
             [-21.392, -18.767, -15.418, -11.750, -9.628, -8.286, -6.945, -5.589, -4.233, -2.878, -1.532, -0.193, 1.158, 2.510, 3.868, 5.186, 6.511, 8.728, 12.635, 16.214, 19.051]
             [-20.754, -17.992, -14.946, -11.371, -9.019, -7.562, -6.247, -4.997, -3.791, -2.571, -1.265, -0.053, 1.127, 2.301, 3.514, 4.794, 6.208, 8.458, 11.940, 14.956, 17.728]];
% %升力系数，-10度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(3,:,:) = [[-25.014, -22.854, -19.634, -15.753, -13.010, -11.014, -8.960, -6.885, -4.859, -2.959, -1.237, 0.353, 1.870, 3.288, 4.667, 6.156, 7.720, 10.041, 13.728, 17.287, 20.165]
             [-30.551, -26.087, -21.025, -16.134, -13.047, -10.917, -8.796, -6.699, -4.660, -2.732, -0.967, 0.718, 2.422, 4.107, 5.795, 7.566, 9.417, 12.248, 17.032, 22.241, 27.064]
             [-22.896, -19.954, -16.230, -12.358, -10.141, -8.645, -7.123, -5.603, -4.069, -2.532, -1.037, 0.424, 1.868, 3.261, 4.627, 6.058, 7.529, 9.795, 13.888, 17.999, 21.387]
             [-21.043, -18.476, -15.199, -11.468, -9.283, -7.889, -6.491, -5.082, -3.684, -2.311, -0.962, 0.362, 1.673, 2.962, 4.240, 5.606, 7.016, 9.295, 13.259, 16.845, 19.650]
             [-20.107, -17.472, -14.460, -10.948, -8.672, -7.213, -5.866, -4.577, -3.208, -1.927, -0.741, 0.386, 1.504, 2.642, 3.844, 5.135, 6.578, 8.888, 12.490, 15.658, 18.343]];
% 
% %升力系数，-5度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(4,:,:) = [[-24.284, -21.770, -18.293, -14.275, -11.514, -9.520, -7.492, -5.529, -3.668, -1.955, -0.441, 0.928, 2.244, 3.683, 5.269, 6.961, 8.707, 11.259, 15.226, 18.855, 21.710]
             [-29.924, -25.307, -20.128, -15.115, -12.005, -9.902, -7.819, -5.789, -3.842, -2.021, -0.379, 1.176, 2.761, 4.459, 6.269, 8.162, 10.118, 13.079, 18.015, 23.310, 28.148]
             [-22.785, -19.702, -15.828, -11.832, -9.547, -8.016, -6.473, -4.939, -3.407, -1.898, -0.455, 0.932, 2.294, 3.698, 5.151, 6.655, 8.178, 10.490, 14.599, 18.679, 22.005]
             [-20.791, -18.239, -14.885, -11.061, -8.807, -7.367, -5.930, -4.499, -3.099, -1.735, -0.426, 0.846, 2.059, 3.365, 4.741, 6.159, 7.611, 9.918, 13.884, 17.426, 20.153]
             [-19.624, -16.969, -14.052, -10.586, -8.272, -6.785, -5.309, -3.905, -2.628, -1.444, -0.337, 0.739, 1.834, 2.978, 4.211, 5.551, 7.054, 9.460, 13.206, 16.181, 18.768]];
% 
% %升力系数，0度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(5,:,:) = [[-23.130 -20.391 -16.781 -12.744 -10.006 -8.104 -6.229 -4.440 -2.777 -1.281 0.000 1.281 2.777 4.440 6.229 8.104 10.006 12.744 16.781 20.391 23.130]
             [-29.105 -24.382 -19.077 -14.064 -11.000 -8.955 -6.957 -5.027 -3.196 -1.503 0.000 1.503 3.196 5.027 6.957 8.955 11.000 14.064 19.077 24.382 29.105]
             [-22.485 -19.267 -15.266 -11.188 -8.876 -7.333 -5.791 -4.279 -2.791 -1.350 0.000 1.350 2.791 4.279 5.791 7.333 8.876 11.188 15.266 19.267 22.485]
             [-20.529 -17.896 -14.444 -10.529 -8.227 -6.769 -5.328 -3.904 -2.532 -1.219 0.000 1.219 2.532 3.904 5.328 6.769 8.227 10.529 14.444 17.896 20.529]
             [-19.137 -16.585 -13.670 -10.148 -7.697 -6.102 -4.679 -3.379 -2.187 -1.068 0.000 1.068 2.187 3.379 4.679 6.102 7.697 10.148 13.670 16.585 19.137]];
% 
% %升力系数，5度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(6,:,:) = [[-21.710, -18.855, -15.226, -11.259, -8.707, -6.961, -5.269, -3.683, -2.244, -0.928, 0.441, 1.955, 3.668, 5.529, 7.492, 9.520, 11.514, 14.275, 18.293, 21.770, 24.284]
             [-28.148, -23.310, -18.015, -13.079, -10.118, -8.162, -6.269, -4.459, -2.761, -1.176, 0.379, 2.021, 3.842, 5.789, 7.819, 9.902, 12.005, 15.115, 20.128, 25.307, 29.924]
             [-22.005, -18.679, -14.599, -10.490, -8.178, -6.655, -5.151, -3.698, -2.294, -0.932, 0.455, 1.898, 3.407, 4.939, 6.473, 8.016, 9.547, 11.832, 15.828, 19.702, 22.785]
             [-20.153, -17.426, -13.884, -9.918, -7.611, -6.159, -4.741, -3.365, -2.059, -0.846, 0.426, 1.735, 3.099, 4.499, 5.930, 7.367, 8.807, 11.061, 14.885, 18.239, 20.791]
             [-18.768, -16.181, -13.206, -9.460, -7.054, -5.551, -4.211, -2.978, -1.834, -0.739, 0.337, 1.444, 2.628, 3.905, 5.309, 6.785, 8.272, 10.586, 14.052, 16.969, 19.624]];
% 
% %升力系数，10度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(7,:,:) = [[-20.165 -17.287 -13.728 -10.041 -7.720 -6.156 -4.667 -3.288 -1.870 -0.353 1.237 2.959 4.859 6.885 8.960 11.014 13.010 15.753 19.634 22.854 25.014]
             [-27.064 -22.241 -17.032 -12.248 -9.417 -7.566 -5.795 -4.107 -2.422 -0.718 0.967 2.732 4.660 6.699 8.796 10.917 13.047 16.134 21.025 26.087 30.551]
             [-21.387 -17.999 -13.888 -9.795 -7.529 -6.058 -4.627 -3.261 -1.868 -0.424 1.037 2.532 4.069 5.603 7.123 8.645 10.141 12.358 16.230 19.954 22.896]
             [-19.650 -16.845 -13.259 -9.295 -7.016 -5.606 -4.240 -2.962 -1.673 -0.362 0.962 2.311 3.684 5.082 6.491 7.889 9.283 11.468 15.199 18.476 21.043]
             [-18.343 -15.658 -12.490 -8.888 -6.578 -5.135 -3.844 -2.642 -1.504 -0.386 0.741 1.927 3.208 4.577 5.866 7.213 8.672 10.948 14.460 17.472 20.107]];
% 
% %升力系数，15度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(8,:,:) = [[-18.605 -15.792 -12.506 -9.161 -7.096 -5.725 -4.318 -2.794 -1.164 0.556 2.334 4.228 6.265 8.334 10.408 12.455 14.412 17.051 20.670 23.425 24.877]
             [-26.013 -21.261 -16.212 -11.616 -8.934 -7.195 -5.470 -3.695 -1.886 -0.066 1.728 3.589 5.595 7.677 9.802 11.915 13.988 16.994 21.771 26.635 30.769]
             [-20.697 -17.281 -13.196 -9.180 -7.001 -5.607 -4.209 -2.782 -1.315 0.182 1.675 3.179 4.700 6.212 7.692 9.158 10.595 12.714 16.449 20.004 22.887]
             [-19.051 -16.214 -12.635 -8.728 -6.511 -5.186 -3.868 -2.510 -1.158 0.193 1.532 2.878 4.233 5.589 6.945 8.286 9.628 11.750 15.418 18.767 21.392]
             [-17.728 -14.956 -11.940 -8.458 -6.208 -4.794 -3.514 -2.301 -1.127 0.053 1.265 2.571 3.791 4.997 6.247 7.562 9.019 11.371 14.946 17.992 20.754]];
% 
% %升力系数，20度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cy(9,:,:) = [[-17.166 -14.582 -11.627 -8.661 -6.751 -5.275 -3.674 -1.963 -0.153 1.731 3.658 5.626 7.661 9.721 11.756 13.730 15.586 18.038 21.173 23.153 24.393]
             [-25.075 -20.451 -15.600 -11.215 -8.610 -6.807 -4.969 -3.087 -1.177 0.735 2.609 4.522 6.557 8.639 10.705 12.750 14.771 17.696 22.271 26.763 30.766]
             [-19.986 -16.597 -12.600 -8.714 -6.582 -5.141 -3.674 -2.197 -0.696 0.813 2.293 3.771 5.254 6.706 8.118 9.506 10.866 12.890 16.465 20.006 22.941]
             [-18.424 -15.596 -12.083 -8.291 -6.138 -4.748 -3.366 -1.972 -0.600 0.748 2.072 3.380 4.679 5.971 7.268 8.556 9.858 11.956 15.726 19.096 21.772]
             [-17.095 -14.443 -11.527 -8.111 -5.878 -4.457 -3.150 -1.890 -0.646 0.627 1.882 3.015 4.162 5.330 6.573 7.950 9.480 11.833 15.506 18.632 21.353]];
 Cz =Cy;
 
% %力矩系数，-20度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(1,:,:) = [[6.270 5.836 5.117 4.127 3.410 2.878 2.333 1.781 1.229 0.687 0.165 -0.354 -0.887 -1.424 -1.956 -2.478 -2.985 -3.664 -4.621 -5.355 -5.819]
                    [8.615 7.519 6.265 4.863 3.949 3.312 2.662 2.006 1.353 0.713 0.104 -0.502 -1.135 -1.780 -2.425 -3.063 -3.687 -4.579 -5.957 -7.204 -8.303]
                    [6.092 5.328 4.486 3.559 2.946 2.513 2.057 1.579 1.083 0.570 0.053 -0.464 -0.977 -1.473 -1.950 -2.406 -2.839 -3.451 -4.379 -5.223 -5.989]
                    [5.508 4.786 4.007 3.163 2.613 2.223 1.816 1.383 0.938 0.487 0.027 -0.432 -0.883 -1.328 -1.761 -2.168 -2.557 -3.105 -3.945 -4.719 -5.435]
                    [5.073 4.401 3.664 2.867 2.324 1.941 1.562 1.181 0.797 0.408 0.013 -0.382 -0.772 -1.155 -1.535 -1.913 -2.294 -2.833 -3.623 -4.353 -5.016]];
% %力矩系数，-15度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(2,:,:) = [[6.277 5.835 5.080 4.071 3.348 2.814 2.267 1.715 1.164 0.623 0.105 -0.407 -0.932 -1.461 -1.984 -2.498 -3.000 -3.687 -4.660 -5.412 -5.889]
                    [8.602 7.502 6.235 4.828 3.913 3.275 2.623 1.966 1.313 0.675 0.069 -0.534 -1.163 -1.804 -2.445 -3.078 -3.699 -4.595 -5.981 -7.238 -8.343]
                    [6.086 5.324 4.483 3.552 2.938 2.503 2.046 1.567 1.069 0.556 0.039 -0.479 -0.991 -1.486 -1.962 -2.417 -2.849 -3.462 -4.393 -5.241 -6.008]
                    [5.497 4.778 4.001 3.159 2.608 2.219 1.811 1.377 0.932 0.480 0.020 -0.439 -0.890 -1.335 -1.768 -2.174 -2.562 -3.112 -3.953 -4.729 -5.446]
                    [5.063 4.393 3.657 2.862 2.320 1.937 1.559 1.179 0.795 0.405 0.009 -0.386 -0.775 -1.158 -1.538 -1.915 -2.296 -2.836 -3.627 -4.358 -5.023]];
% %力矩系数，-10度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(3,:,:) = [[6.265 5.790 5.018 4.003 3.278 2.744 2.198 1.647 1.099 0.565 0.056 -0.447 -0.963 -1.482 -2.000 -2.517 -3.028 -3.726 -4.717 -5.484 -5.969]
                    [8.579 7.468 6.196 4.787 3.871 3.231 2.581 1.925 1.275 0.640 0.039 -0.560 -1.184 -1.820 -2.458 -3.093 -3.719 -4.620 -6.015 -7.280 -8.391]
                    [6.082 5.320 4.475 3.542 2.926 2.490 2.032 1.552 1.054 0.541 0.024 -0.493 -1.003 -1.497 -1.972 -2.427 -2.861 -3.476 -4.410 -5.260 -6.028]
                    [5.488 4.771 3.996 3.153 2.603 2.213 1.804 1.370 0.924 0.472 0.013 -0.446 -0.897 -1.341 -1.773 -2.180 -2.569 -3.120 -3.963 -4.739 -5.457]
                    [5.054 4.386 3.652 2.858 2.316 1.934 1.556 1.175 0.790 0.400 0.005 -0.389 -0.778 -1.161 -1.540 -1.918 -2.299 -2.839 -3.632 -4.365 -5.030]];
% %力矩系数，-5度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(4,:,:) = [[6.209 5.723 4.945 3.928 3.205 2.673 2.129 1.584 1.045 0.519 0.020 -0.473 -0.980 -1.500 -2.027 -2.554 -3.073 -3.783 -4.789 -5.563 -6.053]
                    [8.539 7.426 6.153 4.742 3.826 3.188 2.540 1.888 1.241 0.612 0.015 -0.578 -1.198 -1.834 -2.477 -3.117 -3.747 -4.655 -6.057 -7.328 -8.444]
                    [6.074 5.310 4.462 3.528 2.911 2.474 2.016 1.537 1.039 0.527 0.010 -0.504 -1.013 -1.507 -1.984 -2.441 -2.877 -3.493 -4.428 -5.278 -6.047]
                    [5.481 4.765 3.990 3.147 2.595 2.205 1.796 1.362 0.916 0.465 0.006 -0.453 -0.902 -1.346 -1.779 -2.188 -2.578 -3.129 -3.973 -4.750 -5.466]
                    [5.047 4.380 3.647 2.854 2.313 1.931 1.551 1.170 0.786 0.397 0.002 -0.392 -0.780 -1.163 -1.543 -1.921 -2.303 -2.844 -3.638 -4.370 -5.035]];
% %力矩系数，0度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(5,:,:) = [[6.136 5.645 4.867 3.853 3.134 2.606 2.071 1.535 1.004 0.489 0.000 -0.489 -1.004 -1.535 -2.071 -2.606 -3.134 -3.853 -4.867 -5.645 -6.136]
                    [8.493 7.379 6.104 4.696 3.784 3.149 2.504 1.857 1.215 0.591 0.000 -0.591 -1.215 -1.857 -2.504 -3.149 -3.784 -4.696 -6.104 -7.379 -8.493]
                    [6.063 5.296 4.446 3.511 2.894 2.457 1.999 1.521 1.024 0.514 0.000 -0.514 -1.024 -1.521 -1.999 -2.457 -2.894 -3.511 -4.446 -5.296 -6.063]
                    [5.474 4.758 3.982 3.138 2.587 2.196 1.788 1.354 0.908 0.458 -0.000 -0.458 -0.908 -1.354 -1.788 -2.196 -2.587 -3.138 -3.982 -4.758 -5.474]
                    [5.040 3.643 3.643 2.850 2.308 1.925 1.546 1.166 0.783 0.394 0.000 -0.394 -0.783 -1.166 -1.546 -1.925 -2.308 -2.850 -3.643 -4.375 -5.040]];
% %力矩系数，5度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(6,:,:) = [[6.053 5.563 4.789 3.783 3.073 2.554 2.027 1.500 0.980 0.473  -0.020 -0.519 -1.045 -1.584 -2.129 -2.673 -3.205 -3.928 -4.945 -5.723 -6.209]
                    [8.444 7.328 6.057 4.655 3.747 3.117 2.477 1.834 1.198 0.578 -0.015 -0.612 -1.241 -1.888 -2.540 -3.188 -3.826 -4.742 -6.153 -7.426 -8.539]
                    [6.047 5.278 4.428 3.493 2.877 2.441 1.984 1.507 1.013 0.504 -0.010 -0.527 -1.039 -1.537 -2.016 -2.474 -2.911 -3.528 -4.462 -5.310 -6.074]
                    [5.466 4.750 3.973 3.129 2.578 2.188 1.779 1.346 0.902 0.453 -0.006 -0.465 -0.916 -1.362 -1.796 -2.205 -2.595 -3.147 -3.990 -4.765 -5.481]
                    [5.035 4.370 3.638 2.844 2.303 1.921 1.543 1.163 0.780 0.392 -0.002 -0.397 -0.786 -1.170 -1.551 -1.931 -2.313 -2.854 -3.647 -4.380 -5.047]];
% %力矩系数，10度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(7,:,:) = [[5.969 5.484 4.717 3.726 3.028 2.517 2.000 1.482 0.963 0.447 -0.056 -0.565 -1.099 -1.647 -2.198 -2.744 -3.278 -4.003 -5.018 -5.790 -6.265]
                    [8.391 7.280 6.015 4.620 3.719 3.093 2.458 1.820 1.184 0.560 -0.039 -0.640 -1.275 -1.925 -2.581 -3.231 -3.871 -4.787 -6.196 -7.468 -8.579]
                    [6.028 5.260 4.410 3.476 2.861 2.427 1.972 1.497 1.003 0.493 -0.024 -0.541 -1.054 -1.552 -2.032 -2.490 -2.926 -3.542 -4.475 -5.320 -6.082]
                    [5.457 4.739 3.963 3.120 2.569 2.180 1.773 1.341 0.897 0.446 -0.013 -0.472 -0.924 -1.370 -1.804 -2.213 -2.603 -3.153 -3.996 -4.771 -5.488]
                    [5.030 4.365 3.632 2.839 2.299 1.918 1.540 1.161 0.778 0.389 -0.005 -0.400 -0.790 -1.175 -1.556 -1.934 -2.316 -2.858 -3.652 -4.386 -5.054]];
% %力矩系数，15度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(8,:,:) = [[5.889 5.412 4.660 3.687 3.000 2.498 1.984 1.461 0.932 0.407 -0.105 -0.623 -1.164 -1.715 -2.267 -2.814 -3.348 -4.071 -5.080 -5.835 -6.277]
                    [8.343 7.238 5.981 4.595 3.699 3.078 2.445 1.804 1.163 0.534 -0.069 -0.675 -1.313 -1.966 -2.623 -3.275 -3.913 -4.828 -6.235 -7.502 -8.602]
                    [6.008 5.241 4.393 3.462 2.849 2.417 1.962 1.486 0.991 0.479 -0.039 -0.556 -1.069 -1.567 -2.046 -2.503 -2.938 -3.552 -4.483 -5.324 -6.086]
                    [5.446 4.729 3.953 3.112 2.562 2.174 1.768 1.335 0.890 0.439 -0.020 -0.480 -0.932 -1.377 -1.811 -2.219 -2.608 -3.159 -4.001 -4.778 -5.497]
                    [5.023 4.358 3.627 2.836 2.296 1.915 1.538 1.158 0.775 0.386 -0.009 -0.405 -0.795 -1.179 -1.559 -1.937 -2.320 -2.862 -3.657 -4.393 -5.063]];
% %力矩系数，20度舵偏，-30度到+30度迎角，0.6到2.2马赫
Cmz_alpha(9,:,:) = [[5.819 5.355 4.621 3.664 2.985 2.478 1.956 1.424 0.887 0.354 -0.165 -0.687 -1.229 -1.781 -2.333 -2.878 -3.410 -4.127 -5.117 -5.836 -6.270]
                    [8.303 7.204 5.957 4.579 3.687 3.063 2.425 1.780 1.135 0.502 -0.104 -0.713 -1.353 -2.006 -2.662 -3.312 -3.949 -4.863 -6.265 -7.519 -8.615]
                    [5.989 5.223 4.379 3.451 2.839 2.406 1.950 1.473 0.977 0.464 -0.053 -0.570 -1.083 -1.579 -2.057 -2.513 -2.946 -3.559 -4.486 -5.328 -6.092]
                    [5.435 4.719 3.945 3.105 2.557 2.168 1.761 1.328 0.883 0.432 -0.027 -0.487 -0.938 -1.383 -1.816 -2.223 -2.613 -3.163 -4.007 -4.786 -5.508]
                    [5.016 4.353 3.623 2.833 2.294 1.913 1.535 1.155 0.772 0.382 -0.013 -0.408 -0.797 -1.181 -1.562 -1.941 -2.324 -2.867 -3.664 -4.401 -5.073]];
Cmy_beta = Cmz_alpha;
Mz_wz = zeros(1,11);
Mx_wx = zeros(1,11);
My_wy = zeros(1,11);
% Mz_wz = [-1.94, -1.98, -1.97, -1.99, -2.02, -2.33, -2.44, -2.74, -2.35, -1.84, -1.42]
% Mx_wx = [-3.56, -3.59, -3.56, -3.53, -3.51, -3.59, -3.59, -4.14, -4.01, -3.70, -3.42]
% My_wy = Mz_wz;
% %
% sim('version13')
% figure(1)
% plot(x,y);
% title('30\circ发射角仿真弹道')
% xlabel('导弹射程（单位：m）')
% ylabel('导弹射高（单位：m）')
% xlim([0,19000])
% ylim([0,8000])
% figure(2)
% % sim('version13')
% plot(t,mach);
% title('30\circ发射角导弹飞行速度')
% xlabel('飞行时间（单位：s）')
% ylabel('马赫数')
% total = 4620;
% total_t = 5;
% i1 = 500:500:8000;
% record_mach = [];
% record_height = [];
% for i = 1:length(i1)
%     i2 = (total - 0.5*i1(i))/4.5;
%     P = [i1(i), i1(i), i2, i2, i2, i2, i2, i2, i2, i2, i2];
%     sim('version13')
%     record_mach(i) = mach(length(y(x<=5000)));
%     record_height(i) = y(length(y(x<=5000)));
% end
% figure(1)
% plot(i1, record_mach, 'b', 'linewidth', 1.5);
% title('mach number')
% figure(2)
% plot(i1, record_height, 'b', 'linewidth', 1.5);
% title('height at 5km')
% figure(3)
% plot(i1, (total - 0.5*i1)/4.5, 'b', 'linewidth', 1.5)
